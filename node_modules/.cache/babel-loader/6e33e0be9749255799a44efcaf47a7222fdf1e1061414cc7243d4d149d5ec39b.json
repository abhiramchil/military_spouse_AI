{"ast":null,"code":"var _jsxFileName = \"/Users/cyrus/Documents/Fall 2025/VIP/military_spouse_AI/src/components/RagChatWidget.js\",\n  _s = $RefreshSig$();\nimport React, { forwardRef, useImperativeHandle, useRef, useState } from 'react';\nimport ChatInterface from './ChatInterface';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst generateId = () => {\n  var _globalThis$crypto;\n  if (typeof globalThis !== 'undefined' && (_globalThis$crypto = globalThis.crypto) !== null && _globalThis$crypto !== void 0 && _globalThis$crypto.randomUUID) {\n    return globalThis.crypto.randomUUID();\n  }\n  return `msg_${Math.random().toString(36).slice(2, 10)}`;\n};\nconst normalizeMessage = (message, fallbackType = 'system') => {\n  var _message$id, _message$type, _message$content, _message$timestamp;\n  return {\n    id: (_message$id = message.id) !== null && _message$id !== void 0 ? _message$id : generateId(),\n    type: (_message$type = message.type) !== null && _message$type !== void 0 ? _message$type : fallbackType,\n    content: (_message$content = message.content) !== null && _message$content !== void 0 ? _message$content : '',\n    timestamp: (_message$timestamp = message.timestamp) !== null && _message$timestamp !== void 0 ? _message$timestamp : new Date().toISOString()\n  };\n};\nconst RagChatWidget = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c = _s(({\n  apiUrl,\n  initialMessages = [],\n  placeholder,\n  maxLength\n}, ref) => {\n  _s();\n  const [messages, setMessages] = useState(initialMessages.map(msg => normalizeMessage(msg, 'bot')));\n  const [isLoading, setIsLoading] = useState(false);\n  const messagesRef = useRef(messages);\n  const updateMessages = next => {\n    messagesRef.current = next;\n    setMessages(next);\n  };\n  const sendMessage = async rawText => {\n    const trimmed = rawText.trim();\n    if (!trimmed || !apiUrl) return;\n    const userMessage = normalizeMessage({\n      type: 'user',\n      content: trimmed\n    }, 'user');\n    updateMessages([...messagesRef.current, userMessage]);\n    setIsLoading(true);\n    try {\n      const response = await fetch(apiUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          message: trimmed\n        })\n      });\n      if (!response.ok) return;\n      const data = await response.json();\n      let replyText = '';\n      if (typeof data === 'string') {\n        replyText = data;\n      } else if (data && typeof data === 'object') {\n        var _ref, _ref2, _ref3, _data$reply;\n        replyText = (_ref = (_ref2 = (_ref3 = (_data$reply = data.reply) !== null && _data$reply !== void 0 ? _data$reply : data.response) !== null && _ref3 !== void 0 ? _ref3 : data.answer) !== null && _ref2 !== void 0 ? _ref2 : data.output) !== null && _ref !== void 0 ? _ref : '';\n      }\n      if (!replyText.trim()) return;\n      const botMessage = normalizeMessage({\n        type: 'bot',\n        content: replyText\n      }, 'bot');\n      updateMessages([...messagesRef.current, botMessage]);\n    } catch (err) {\n      // swallow errors for minimal implementation\n      console.error(err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  useImperativeHandle(ref, () => ({\n    sendMessage,\n    resetConversation: () => updateMessages(initialMessages.map(msg => normalizeMessage(msg, 'bot'))),\n    getMessages: () => messagesRef.current\n  }), [initialMessages]);\n  return /*#__PURE__*/_jsxDEV(ChatInterface, {\n    messages: messages,\n    onSendMessage: sendMessage,\n    isTyping: isLoading,\n    inputDisabled: isLoading,\n    placeholder: placeholder,\n    maxLength: maxLength\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 7\n  }, this);\n}, \"1RPEXyCZcr8xyM1PIgtxA5xoBUQ=\")), \"1RPEXyCZcr8xyM1PIgtxA5xoBUQ=\");\n_c2 = RagChatWidget;\nexport default RagChatWidget;\nvar _c, _c2;\n$RefreshReg$(_c, \"RagChatWidget$forwardRef\");\n$RefreshReg$(_c2, \"RagChatWidget\");","map":{"version":3,"names":["React","forwardRef","useImperativeHandle","useRef","useState","ChatInterface","jsxDEV","_jsxDEV","generateId","_globalThis$crypto","globalThis","crypto","randomUUID","Math","random","toString","slice","normalizeMessage","message","fallbackType","_message$id","_message$type","_message$content","_message$timestamp","id","type","content","timestamp","Date","toISOString","RagChatWidget","_s","_c","apiUrl","initialMessages","placeholder","maxLength","ref","messages","setMessages","map","msg","isLoading","setIsLoading","messagesRef","updateMessages","next","current","sendMessage","rawText","trimmed","trim","userMessage","response","fetch","method","headers","body","JSON","stringify","ok","data","json","replyText","_ref","_ref2","_ref3","_data$reply","reply","answer","output","botMessage","err","console","error","resetConversation","getMessages","onSendMessage","isTyping","inputDisabled","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["/Users/cyrus/Documents/Fall 2025/VIP/military_spouse_AI/src/components/RagChatWidget.js"],"sourcesContent":["import React, { forwardRef, useImperativeHandle, useRef, useState } from 'react';\nimport ChatInterface from './ChatInterface';\n\nconst generateId = () => {\n  if (typeof globalThis !== 'undefined' && globalThis.crypto?.randomUUID) {\n    return globalThis.crypto.randomUUID();\n  }\n  return `msg_${Math.random().toString(36).slice(2, 10)}`;\n};\n\nconst normalizeMessage = (message, fallbackType = 'system') => ({\n  id: message.id ?? generateId(),\n  type: message.type ?? fallbackType,\n  content: message.content ?? '',\n  timestamp: message.timestamp ?? new Date().toISOString()\n});\n\nconst RagChatWidget = forwardRef(\n  (\n    {\n      apiUrl,\n      initialMessages = [],\n      placeholder,\n      maxLength\n    },\n    ref\n  ) => {\n    const [messages, setMessages] = useState(\n      initialMessages.map((msg) => normalizeMessage(msg, 'bot'))\n    );\n    const [isLoading, setIsLoading] = useState(false);\n    const messagesRef = useRef(messages);\n\n    const updateMessages = (next) => {\n      messagesRef.current = next;\n      setMessages(next);\n    };\n\n    const sendMessage = async (rawText) => {\n      const trimmed = rawText.trim();\n      if (!trimmed || !apiUrl) return;\n\n      const userMessage = normalizeMessage({ type: 'user', content: trimmed }, 'user');\n      updateMessages([...messagesRef.current, userMessage]);\n      setIsLoading(true);\n\n      try {\n        const response = await fetch(apiUrl, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({ message: trimmed })\n        });\n\n        if (!response.ok) return;\n\n        const data = await response.json();\n        let replyText = '';\n\n        if (typeof data === 'string') {\n          replyText = data;\n        } else if (data && typeof data === 'object') {\n          replyText =\n            data.reply ??\n            data.response ??\n            data.answer ??\n            data.output ??\n            '';\n        }\n\n        if (!replyText.trim()) return;\n\n        const botMessage = normalizeMessage({ type: 'bot', content: replyText }, 'bot');\n        updateMessages([...messagesRef.current, botMessage]);\n      } catch (err) {\n        // swallow errors for minimal implementation\n        console.error(err);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    useImperativeHandle(\n      ref,\n      () => ({\n        sendMessage,\n        resetConversation: () => updateMessages(initialMessages.map((msg) => normalizeMessage(msg, 'bot'))),\n        getMessages: () => messagesRef.current\n      }),\n      [initialMessages]\n    );\n\n    return (\n      <ChatInterface\n        messages={messages}\n        onSendMessage={sendMessage}\n        isTyping={isLoading}\n        inputDisabled={isLoading}\n        placeholder={placeholder}\n        maxLength={maxLength}\n      />\n    );\n  }\n);\n\nexport default RagChatWidget;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}